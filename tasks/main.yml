---
- import_tasks: repository.yml
  tags: 1_repository,slave

- import_tasks: install.yml
  tags: 2_install,slave

- import_tasks: initialize.yml
  tags: 3_init
  when: postgresql_service != "patroni"

- import_tasks: postgresql_conf.yml
  tags: 4_config
  when: postgresql_service != "patroni"

- import_tasks: patroni-setup.yml
  when: postgresql_service == "patroni"

- import_tasks: security.yml
  tags: 5_security

- import_tasks: start.yml
  tags: 6_startdb
  when: postgresql_service != "patroni"

- import_tasks: patroni-check.yml
  when: postgresql_service == "patroni"

- import_tasks: powa.yml
  tags: powa
  when: output.json.role == 'master' or postgresql_service != "patroni"

- import_tasks: repmgr.yml
  tags: repmgr
  when: postgresql_service != "patroni"

- import_tasks: pgbackrest.yml
  when: pgbackrest_dir is defined and postgresql_service != "patroni"
  tags: pgbackrest

- import_tasks: pgbadger.yml
  tags: pgbadger
  when: postgresql_service != "patroni"

- import_tasks: check_restart.yml
  tags: check_restart
